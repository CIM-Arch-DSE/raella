architecture:
    version: '0.4'
    subtree:
      - name: top_level
        attributes:
            ACTUAL_WEIGHT_BITS: 8
            CIM_UNITS_PER_WEIGHT: '8'
            BITS_PER_CELL: 4
            WEIGHT_BITS: BITS_PER_CELL * CIM_UNITS_PER_WEIGHT * 2
            INPUT_BITS: 8
            OUTPUT_BITS: 8
            BATCH_SIZE: 32
            AVERAGE_INPUT_VALUE: '0.46209163933997927'
            AVERAGE_WEIGHT_VALUE: 0.010027026929520844 / 15 * 15
            SUPPORTED_INPUT_BITS: 8
            SUPPORTED_WEIGHT_BITS: 8
            SUPPORTED_OUTPUT_BITS: 8
            TILES_PER_ARCH: 16
            MACROS_PER_TILE: 8
            CROSSBARS_PER_MACRO: 4
            COLUMNS_PER_CROSSBAR: 512
            CIM_UNITS_PER_COLUMN: 512
            CIM_UNIT_WIDTH_CELLS: 2
            CIM_UNIT_DEPTH_CELLS: 1
            CIM_UNIT_WIDTH_BITS: CIM_UNIT_WIDTH_CELLS * BITS_PER_CELL
            ROWS_PER_CROSSBAR: CIM_UNITS_PER_COLUMN * CIM_UNIT_DEPTH_CELLS
            COLS_PER_CROSSBAR: COLUMNS_PER_CROSSBAR
            CELLS_PER_CROSSBAR: ROWS_PER_CROSSBAR * COLS_PER_CROSSBAR
            STORAGE_PER_CROSSBAR: CELLS_PER_CROSSBAR * BITS_PER_CELL
            ROWS_PER_MACRO: ROWS_PER_CROSSBAR * CROSSBARS_PER_MACRO
            COLS_PER_MACRO: COLS_PER_CROSSBAR * CROSSBARS_PER_MACRO
            CELLS_PER_MACRO: CELLS_PER_CROSSBAR * CROSSBARS_PER_MACRO
            STORAGE_PER_MACRO: STORAGE_PER_CROSSBAR * CROSSBARS_PER_MACRO
            ADC_RESOLUTION: 7
            DAC_RESOLUTION: 1
            VOLTAGE: 0.7
            LATENCY: 1.0e-9
            CROSSBAR_LATENCY_PRE_SPECULATION: LATENCY * 100
            TECH_NODE: 32
            CELL_CONFIG: getcwd() + "/cell_configs/raella.cell"
            INF: 2147483647
            N_VIRTUAL_MACS: DAC_RESOLUTION * CIM_UNIT_WIDTH_BITS * OUTPUT_BITS
            N_SHIFT_ADDS_PER_BANK: 4
            DOUBLE_WIDTH_OUTPUT_REG: false
            N_ADC_PER_BANK: 4
            COLUMN_READOUT_CLASS: "isaac_adc"
            SPECULATION_ENABLED: 1
            ADC_ACTION_SHARE: '0.3824094213850083'
            CROSSBAR_LATENCY: CROSSBAR_LATENCY_PRE_SPECULATION * (11 / 8 if SPECULATION_ENABLED
                else 1)
        local:
          - name: chip[1..1]
            attributes:
                depth: 2147483647
                width: 2147483647
                reduction_supported: false
                datawidth: 1
                n_banks: 2
                cluster_size: 1
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 1
                meshY: 1
                technology: 32
                latency: 1
                cell_config: "/home/workspace/cell_configs/raella.cell"
            class: dummy_storage
            required_actions:
              - update
              - read
              - write
          - name: inter_tile_spatial_dummy[1..1]
            class: dummy_storage
            attributes:
                width: 1
                depth: 1
                datawidth: 1
                technology: -1
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 1
                meshY: 1
                latency: 1
                cell_config: "/home/workspace/cell_configs/raella.cell"
          - name: on_chip_network[1..16]
            subclass: isaac_router
            attributes:
                width: 256
                depth: 2147483647
                datawidth: 1
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 16
                meshY: 1
                technology: 32
                latency: 1
                cell_config: "/home/workspace/cell_configs/raella.cell"
            class: dummy_storage
            required_actions:
              - update
              - read
              - write
          - name: eDRAM_buf[1..16]
            subclass: isaac_edram
            attributes:
                depth: 2048
                width: 256
                datawidth: 1
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 16
                meshY: 1
                technology: 32
                latency: 1
                cell_config: "/home/workspace/cell_configs/raella.cell"
            class: dummy_storage
            required_actions:
              - update
              - read
              - write
          - name: output_quantize[1..16]
            subclass: output_quantize_edram
            attributes:
                depth: 2048
                width: 256
                storage_for_scales: 262144
                datawidth: 1
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 16
                meshY: 1
                technology: 32
                latency: 1
                cell_config: "/home/workspace/cell_configs/raella.cell"
            class: dummy_storage
            required_actions:
              - update
              - read
              - write
          - name: inter_macro_spatial_dummy[1..16]
            class: dummy_storage
            attributes:
                width: 1
                depth: 1
                datawidth: 1
                technology: -1
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 16
                meshY: 1
                latency: 1
                cell_config: "/home/workspace/cell_configs/raella.cell"
          - name: inter_tile_network[1..128]
            subclass: isaac_eDRAM_bus
            attributes:
                width: 256
                depth: 2147483647
                datawidth: 1
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 128
                meshY: 1
                technology: 32
                latency: 1
                cell_config: "/home/workspace/cell_configs/raella.cell"
            class: dummy_storage
            required_actions:
              - update
              - read
              - write
          - name: output_center_offset_correct[1..128]
            subclass: raella_output_center_offset_correct
            attributes:
                width: 8
                center_entries: 256
                depth: 2147483647
                datawidth: 1
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 128
                meshY: 1
                technology: 32
                latency: 1
                cell_config: "/home/workspace/cell_configs/raella.cell"
            class: dummy_storage
            required_actions:
              - update
              - read
              - write
          - name: input_buffer[1..128]
            subclass: raella_input_buffer
            attributes:
                width: 32
                depth: 512
                adc_action_share: 0.3824094213850083
                input_bits: 8
                datawidth: 1
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 128
                meshY: 1
                technology: 32
                latency: 1
                cell_config: "/home/workspace/cell_configs/raella.cell"
            class: dummy_storage
            required_actions:
              - update
              - read
              - write
          - name: inter_crossbar_spatial_dummy[1..128]
            class: dummy_storage
            attributes:
                width: 1
                depth: 1
                datawidth: 1
                technology: -1
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 128
                meshY: 1
                latency: 1
                cell_config: "/home/workspace/cell_configs/raella.cell"
          - name: output_register[1..512]
            subclass: raella_output_register
            attributes:
                entry_bits: 16
                width: 128
                n_entries: 256
                depth: 32
                datawidth: 2
                speculation_adc_scale: 0.3824094213850083
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 512
                meshY: 1
                technology: 32
                latency: 1
                cell_config: "/home/workspace/cell_configs/raella.cell"
            class: dummy_storage
            required_actions:
              - update
              - read
              - write
          - name: shift_add[1..512]
            subclass: shift_add_with_adc_action_share
            attributes:
                width: 8
                depth: 2147483647
                datawidth: 1
                resolution: 7
                n_adcs: 4
                adc_action_share: 0.3824094213850083
                rows: 512
                cols: 1024
                cols_active_at_once: 512
                cell_config: "/home/workspace/cell_configs/raella.cell"
                average_input_value: 0.46209163933997927
                average_cell_value: 0.010027026929520844
                latency: 1.375e-07
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 512
                meshY: 1
                technology: 32
            class: dummy_storage
            required_actions:
              - update
              - read
              - write
          - name: column_readout[1..512]
            subclass: column_readout
            attributes:
                bw_speculation_scale: 0.7272727272727273
                width: 8
                include_column_drivers: 0
                depth: 2147483647
                datawidth: 1
                resolution: 7
                n_adcs: 4
                adc_action_share: 0.3824094213850083
                rows: 512
                cols: 1024
                cols_active_at_once: 512
                cell_config: "/home/workspace/cell_configs/raella.cell"
                average_input_value: 0.46209163933997927
                average_cell_value: 0.010027026929520844
                latency: 1.375e-07
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 512
                meshY: 1
                technology: 32
            class: dummy_storage
            required_actions:
              - update
              - read
              - write
          - name: input_drivers[1..512]
            subclass: raella_dac
            attributes:
                n_components: 512
                width: 1
                n_banks: 1
                rows: 512
                cols: 1024
                cols_active_at_once: 512
                cell_config: "/home/workspace/cell_configs/raella.cell"
                average_input_value: 0.46209163933997927
                average_cell_value: 0.010027026929520844
                latency: 1.375e-07
                depth: 2147483647
                datawidth: 1
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 512
                meshY: 1
                technology: 32
            class: dummy_storage
            required_actions:
              - update
              - read
              - write
          - name: inter_col_analog_inputs[1..512]
            attributes:
                width: 1
                depth: 512
                datawidth: 1
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 512
                meshY: 1
                technology: 32
                latency: 1
                cell_config: "/home/workspace/cell_configs/raella.cell"
            class: dummy_storage
            required_actions:
              - update
              - read
              - write
          - name: inter_column_spatial_dummy[1..512]
            class: dummy_storage
            attributes:
                width: 1
                depth: 1
                datawidth: 1
                technology: -1
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 512
                meshY: 1
                latency: 1
                cell_config: "/home/workspace/cell_configs/raella.cell"
          - name: timely_psubbuf[1..262144]
            subclass: timely_psubbuf
            attributes:
                width: 8
                technology: 65
                depth: 2147483647
                datawidth: 1
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 262144
                meshY: 1
                latency: 1
                cell_config: "/home/workspace/cell_configs/raella.cell"
            class: dummy_storage
            required_actions:
              - update
              - read
              - write
          - name: inter_cim_unit_spatial_dummy[1..262144]
            class: dummy_storage
            attributes:
                width: 1
                depth: 1
                datawidth: 1
                technology: -1
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 262144
                meshY: 1
                latency: 1
                cell_config: "/home/workspace/cell_configs/raella.cell"
          - name: pim_cell[1..134217728]
            subclass: cell
            attributes:
                width: 8
                depth: 1
                width_cells: 2
                cycles_per_activation: 137.5
                read_bandwidth: 0.05818181818181818
                rows: 512
                cols: 1024
                cols_active_at_once: 512
                cell_config: "/home/workspace/cell_configs/raella.cell"
                average_input_value: 0.46209163933997927
                average_cell_value: 0.010027026929520844
                latency: 1.375e-07
                datawidth: 1
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 134217728
                meshY: 1
                technology: 32
            class: dummy_storage
            required_actions:
              - update
              - read
              - write
          - name: inter_bitwise_virtualization_spatial_dummy[1..134217728]
            class: dummy_storage
            attributes:
                width: 1
                depth: 1
                datawidth: 1
                technology: -1
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 134217728
                meshY: 1
                latency: 1
                cell_config: "/home/workspace/cell_configs/raella.cell"
          - name: bugfix[1..8589934592]
            attributes:
                width: 1
                depth: 1
                datawidth: 1
                n_banks: 2
                cluster_size: 1
                reduction_supported: true
                multiple_buffering: 1
                min_utilization: 0
                allow_overbooking: false
                meshX: 8589934592
                meshY: 1
                technology: 32
                latency: 1
                cell_config: "/home/workspace/cell_configs/raella.cell"
            class: dummy_storage
            required_actions:
              - update
              - read
              - write
          - name: virtual_bitwise_mac[1..8589934592]
            class: free_mac
            required_actions:
              - compute
            attributes:
                meshX: 8589934592
                meshY: 1
                technology: 32
                latency: 1
                cell_config: "/home/workspace/cell_configs/raella.cell"
architecture_constraints:
    targets:
      - type: bypass
        bypass:
          - Weights
        keep:
          - Inputs
          - Outputs
        target: chip
      - factors: Q=-1,N=-1,P=1,I=1,T=1,C=1,M=1,R=1,S=1,L=1,G=1
        permutation: GLSRMCTIPQN
        type: temporal
        target: chip
      - type: spatial
        factors: L=1,C=1,R=1,S=1,M=1,G=1,N=16,Q=1,P=1,I=1,T=1
        permutation: NPQICMRSLTG
        no_multicast_no_reduction:
          - Inputs
          - Outputs
          - Weights
        no_link_transfer:
          - Inputs
          - Outputs
          - Weights
        split: 999
        target: inter_tile_spatial_dummy
      - factors: C=1,M=1,R=1,S=1,N=1,P=1,Q=1,I=1,L=1,T=1,G=1
        permutation: CMRSNPQILTG
        type: temporal
        target: inter_tile_spatial_dummy
      - bypass:
          - Weights
          - Inputs
          - Outputs
        type: bypass
        target: inter_tile_spatial_dummy
      - passthrough:
          - Inputs
          - Outputs
        keep:
          - Inputs
          - Outputs
        bypass:
          - Weights
        type: bypass
        target: on_chip_network
      - permutation: NPQICMRSLTG
        rmw_on_first_writeback:
          - Inputs
          - Outputs
          - Weights
        type: temporal
        factors: C=1,M=1,R=1,S=1,N=1,P=1,Q=1,I=1,L=1,T=1,G=1
        target: on_chip_network
      - type: bypass
        bypass:
          - Weights
        keep:
          - Inputs
          - Outputs
        target: eDRAM_buf
      - factors: T=1,N=1,C=1,M=1,R=1,S=1,L=1,G=1
        type: temporal
        permutation: QPGLSRMCNT
        target: eDRAM_buf
      - keep:
          - Outputs
        bypass:
          - Inputs
          - Weights
        type: bypass
        target: output_quantize
      - permutation: NPQICMRSLTG
        rmw_on_first_writeback:
          - Inputs
          - Outputs
          - Weights
        type: temporal
        factors: C=1,M=1,R=1,S=1,N=1,P=1,Q=1,I=1,L=1,T=1,G=1
        target: output_quantize
      - type: spatial
        factors: C=1,R=1,S=1,M=4,G=1
        permutation: NPQICMRSLTG
        no_multicast_no_reduction:
          - Inputs
          - Outputs
          - Weights
        no_link_transfer:
          - Inputs
          - Outputs
          - Weights
        split: 999
        target: inter_macro_spatial_dummy
      - factors: C=1,M=1,R=1,S=1,N=1,P=1,Q=1,I=1,L=1,T=1,G=1
        permutation: CMRSNPQILTG
        type: temporal
        target: inter_macro_spatial_dummy
      - bypass:
          - Weights
          - Inputs
          - Outputs
        type: bypass
        target: inter_macro_spatial_dummy
      - permutation: NPQICMRSLTG
        rmw_on_first_writeback:
          - Inputs
          - Outputs
          - Weights
        type: temporal
        factors: C=1,M=1,R=1,S=1,N=1,P=1,Q=1,I=1,L=1,T=1,G=1
        target: inter_tile_network
      - passthrough:
          - Inputs
          - Outputs
        keep:
          - Inputs
          - Outputs
        bypass:
          - Weights
        type: bypass
        target: inter_tile_network
      - passthrough:
          - Outputs
        keep:
          - Outputs
        bypass:
          - Inputs
          - Weights
        type: bypass
        target: output_center_offset_correct
      - permutation: NPQICMRSLTG
        rmw_on_first_writeback:
          - Inputs
          - Outputs
          - Weights
        type: temporal
        factors: C=1,M=1,R=1,S=1,N=1,P=1,Q=1,I=1,L=1,T=1,G=1
        target: output_center_offset_correct
      - keep:
          - Inputs
        bypass:
          - Outputs
          - Weights
        type: bypass
        target: input_buffer
      - factors: T=1,N=1,C=1,M=1,R=1,S=1,L=1,G=1
        type: temporal
        permutation: QPGLSRMCNT
        target: input_buffer
      - type: spatial
        factors: C=1,R=1,S=1,M=4,N=1,P=1,Q=1,I=1,L=1,T=1,G=1
        permutation: NPQICMRSLTG
        no_link_transfer:
          - Inputs
          - Outputs
          - Weights
        split: 999
        target: inter_crossbar_spatial_dummy
      - factors: C=1,M=1,R=1,S=1,N=1,P=1,Q=1,I=1,L=1,T=1,G=1
        permutation: CMRSNPQILTG
        type: temporal
        target: inter_crossbar_spatial_dummy
      - bypass:
          - Weights
          - Inputs
          - Outputs
        type: bypass
        target: inter_crossbar_spatial_dummy
      - type: bypass
        bypass:
          - Inputs
          - Weights
        keep:
          - Outputs
        target: output_register
      - factors: I=0,N=1,P=1,Q=1,T=1,C=1,M=1,R=1,S=1,L=1,G=1
        type: temporal
        permutation: GLSRMCTQPN
        target: output_register
      - no_temporal_reuse:
          - Inputs
          - Outputs
          - Weights
        permutation: NPQICMRSLTG
        rmw_on_first_writeback:
          - Inputs
          - Outputs
          - Weights
        type: temporal
        factors: C=1,M=1,R=1,S=1,N=1,P=1,Q=1,I=1,L=1,T=1,G=1
        target: shift_add
      - keep:
          - Outputs
        bypass:
          - Inputs
          - Weights
        type: bypass
        target: shift_add
      - passthrough:
          - Outputs
        keep:
          - Outputs
        bypass:
          - Inputs
          - Weights
        type: bypass
        target: column_readout
      - permutation: NPQICMRSLTG
        rmw_on_first_writeback:
          - Inputs
          - Outputs
          - Weights
        type: temporal
        factors: C=1,M=1,R=1,S=1,N=1,P=1,Q=1,I=1,L=1,T=1,G=1
        target: column_readout
      - passthrough:
          - Inputs
        keep:
          - Inputs
        bypass:
          - Outputs
          - Weights
        type: bypass
        target: input_drivers
      - permutation: NPQICMRSLTG
        rmw_on_first_writeback:
          - Inputs
          - Outputs
          - Weights
        type: temporal
        factors: C=1,M=1,R=1,S=1,N=1,P=1,Q=1,I=1,L=1,T=1,G=1
        target: input_drivers
      - permutation: NPQICMRSLTG
        rmw_on_first_writeback:
          - Inputs
          - Outputs
          - Weights
        type: temporal
        factors: C=1,M=1,R=1,S=1,N=1,P=1,Q=1,I=1,L=1,T=1,G=1
        no_temporal_reuse:
          - Weights
          - Inputs
          - Outputs
        target: inter_col_analog_inputs
      - keep:
          - Inputs
        bypass:
          - Outputs
          - Weights
        type: bypass
        target: inter_col_analog_inputs
      - type: spatial
        factors: Q=1,L=8,M=64,C=1,R=1,S=1,N=1,P=1,I=1,T=1,G=1
        permutation: NPQICMRSLTG
        no_multicast_no_reduction:
          - Outputs
          - Weights
        no_link_transfer:
          - Inputs
          - Outputs
          - Weights
        split: 999
        target: inter_column_spatial_dummy
      - factors: C=1,M=1,R=1,S=1,N=1,P=1,Q=1,I=1,L=1,T=1,G=1
        permutation: CMRSNPQILTG
        type: temporal
        target: inter_column_spatial_dummy
      - bypass:
          - Weights
          - Inputs
          - Outputs
        type: bypass
        target: inter_column_spatial_dummy
      - passthrough:
          - Outputs
        keep:
          - Outputs
        bypass:
          - Inputs
          - Weights
        type: bypass
        target: timely_psubbuf
      - permutation: NPQICMRSLTG
        rmw_on_first_writeback:
          - Inputs
          - Outputs
          - Weights
        type: temporal
        factors: C=1,M=1,R=1,S=1,N=1,P=1,Q=1,I=1,L=1,T=1,G=1
        target: timely_psubbuf
      - type: spatial
        factors: N=1,M=1,Q=1,P=1,T=1,G=1,C=512,R=1,S=1,I=1,L=1
        permutation: NPQICMRSLTG
        no_multicast_no_reduction:
          - Inputs
          - Weights
        no_link_transfer:
          - Inputs
          - Outputs
          - Weights
        split: 999
        target: inter_cim_unit_spatial_dummy
      - factors: C=1,M=1,R=1,S=1,N=1,P=1,Q=1,I=1,L=1,T=1,G=1
        permutation: CMRSNPQILTG
        type: temporal
        target: inter_cim_unit_spatial_dummy
      - bypass:
          - Weights
          - Inputs
          - Outputs
        type: bypass
        target: inter_cim_unit_spatial_dummy
      - keep:
          - Weights
        bypass:
          - Inputs
          - Outputs
        type: bypass
        target: pim_cell
      - permutation: NPQICMRSLTG
        factors: C=1,R=1,S=1,I=1,L=1,N=1,M=1,Q=1,P=1,T=1,G=1
        type: temporal
        target: pim_cell
      - type: spatial
        factors: I=1,L=8,T=0,C=1,M=1,R=1,S=1,N=1,P=1,Q=1,G=1
        permutation: NPQICMRSLTG
        split: 999
        target: inter_bitwise_virtualization_spatial_dummy
      - factors: C=1,M=1,R=1,S=1,N=1,P=1,Q=1,I=1,L=1,T=1,G=1
        permutation: CMRSNPQILTG
        type: temporal
        target: inter_bitwise_virtualization_spatial_dummy
      - bypass:
          - Weights
          - Inputs
          - Outputs
        type: bypass
        target: inter_bitwise_virtualization_spatial_dummy
      - type: bypass
        bypass:
          - Weights
          - Outputs
          - Inputs
        target: bugfix
      - permutation: NPQICMRSLTG
        rmw_on_first_writeback:
          - Inputs
          - Outputs
          - Weights
        type: temporal
        factors: C=1,M=1,R=1,S=1,N=1,P=1,Q=1,I=1,L=1,T=1,G=1
        target: bugfix
problem:
    instance:
        C: 512
        G: 1
        H: 1
        Hdilation: 1
        Hpad: 0
        Hstride: 1
        I: 8
        L: 64
        M: 1024
        N: 32
        P: 1
        Q: 1
        R: 1
        S: 1
        T: 8
        W: 1
        Wdilation: 1
        Wpad: 0
        Wstride: 1
        densities: {}
    shape:
        coefficients:
          - default: 1
            name: Wstride
          - default: 1
            name: Hstride
          - default: 1
            name: Wdilation
          - default: 1
            name: Hdilation
        data_spaces:
          - name: Weights
            projection:
              -   -   - C
              -   -   - M
              -   -   - R
              -   -   - S
              -   -   - L
              -   -   - G
            read_write: false
          - name: Inputs
            projection:
              -   -   - N
              -   -   - C
              -   -   - R
                      - Wdilation
                  -   - P
                      - Wstride
              -   -   - S
                      - Hdilation
                  -   - Q
                      - Hstride
              -   -   - I
              -   -   - G
            read_write: false
          - name: Outputs
            projection:
              -   -   - N
              -   -   - M
              -   -   - Q
              -   -   - P
              -   -   - T
              -   -   - G
            read_write: true
        dimensions:
          - C
          - M
          - R
          - S
          - N
          - P
          - Q
          - I
          - L
          - T
          - G
        name: FC
compound_components:
    version: '0.4'
    classes:
      - name: d_flip_flop
        attributes:
            technology: "must_specify"
            n_bits: "must_specify"
        subcomponents:
          - name: ff
            class: flip_flop
            attributes:
                technology: technology
                n_bits: n_bits
        actions:
          - name: read
            subcomponents: {}
          - name: write
            subcomponents: {}
          - name: update
            subcomponents: {}
          - name: idle
            subcomponents: {}
      - name: output_quantize_edram
        attributes:
            width: "must_specify"
            depth: "must_specify"
            technology: "must_specify"
            storage_for_scales: "must_specify"
        subcomponents:
          - name: edram_scales
            class: isaac_edram
            attributes:
                technology: technology
                depth: depth
                width: storage_for_scales // depth
          - name: multiplier
            class: raella_quant_multiplier
            attributes:
                technology: technology
        actions:
          - name: read
            subcomponents:
              - name: edram_scales
                actions:
                  - name: read
              - name: multiplier
                actions:
                  - name: multiply
                    action_share: width // 8
          - name: write
            subcomponents: []
          - name: update
            subcomponents: []
          - name: idle
            subcomponents: []
      - name: input_row_drivers
        attributes:
            technology: "must_specify"
            rows: "must_specify"
            cols: "must_specify"
            cols_active_at_once: "must_specify"
            cell_config: "must_specify"
            average_input_value: "must_specify"
            average_cell_value: "must_specify"
            latency: "must_specify"
            voltage_dac_bits: null
            temporal_dac_bits: null
            temporal_spiking: null
            adc_action_share: 1
            adc_area_share: 1
            read_pulse_width: 1e-9
        subcomponents:
          - name: pim_row_drivers
            class: array_row_drivers
            attributes:
                technology: technology
                rows: rows
                cols: cols
                cols_active_at_once: cols_active_at_once
                cell_config: cell_config
                average_input_value: average_input_value
                average_cell_value: average_cell_value
                latency: latency
                voltage_dac_bits: voltage_dac_bits
                temporal_dac_bits: temporal_dac_bits
                temporal_spiking: temporal_spiking
                read_pulse_width: read_pulse_width
        actions:
          - name: read
            subcomponents:
              - name: pim_row_drivers
                actions:
                  - name: read
          - name: idle
            subcomponents:
              - name: pim_row_drivers
                actions:
                  - name: idle
          - name: write
            subcomponents: []
          - name: update
            subcomponents: []
      - name: weight_row_drivers
        attributes:
            technology: "must_specify"
            rows: "must_specify"
            cols: "must_specify"
            cols_active_at_once: "must_specify"
            cell_config: "must_specify"
            average_input_value: "must_specify"
            average_cell_value: "must_specify"
            latency: "must_specify"
            voltage_dac_bits: null
            temporal_dac_bits: null
            temporal_spiking: null
            adc_action_share: 1
            adc_area_share: 1
            read_pulse_width: 1e-9
        subcomponents:
          - name: pim_row_drivers
            class: INPUT_DRIVERS_CLASS
            attributes:
                technology: technology
                rows: rows
                cols: cols
                cols_active_at_once: cols_active_at_once
                cell_config: cell_config
                average_input_value: average_input_value
                average_cell_value: average_cell_value
                latency: latency
                voltage_dac_bits: voltage_dac_bits
                temporal_dac_bits: temporal_dac_bits
                temporal_spiking: temporal_spiking
                read_pulse_width: read_pulse_width
            area_share: 0
        actions:
          - name: read
            subcomponents:
              - name: pim_row_drivers
                actions:
                  - name: write
          - name: write
            subcomponents: []
          - name: idle
            subcomponents: []
          - name: update
            subcomponents: []
      - name: cell
        attributes:
            width_cells: "must_specify"
            technology: "must_specify"
            rows: "must_specify"
            cols: "must_specify"
            cols_active_at_once: "must_specify"
            cell_config: "must_specify"
            average_input_value: "must_specify"
            average_cell_value: "must_specify"
            latency: "must_specify"
            voltage_dac_bits: null
            temporal_dac_bits: null
            temporal_spiking: null
            adc_action_share: 1
            adc_area_share: 1
            read_pulse_width: 1e-9
        subcomponents:
          - name: cell
            class: memory_cell
            attributes:
                adc_resolution: 0
                technology: technology
                rows: rows
                cols: cols
                cols_active_at_once: cols_active_at_once
                cell_config: cell_config
                average_input_value: average_input_value
                average_cell_value: average_cell_value
                latency: latency
                voltage_dac_bits: voltage_dac_bits
                temporal_dac_bits: temporal_dac_bits
                temporal_spiking: temporal_spiking
                read_pulse_width: read_pulse_width
            area_share: width_cells
        actions:
          - name: read
            subcomponents:
              - name: cell
                actions:
                  - name: read
                    action_share: width_cells
          - name: write
            subcomponents:
              - name: cell
                actions:
                  - name: write
          - name: idle
            subcomponents:
              - name: cell
                actions:
                  - name: idle
                    action_share: width_cells
          - name: update
            subcomponents: []
      - name: column_readout
        attributes:
            resolution: "must_specify"
            n_adcs: "must_specify"
            include_column_drivers: "must_specify"
            technology: "must_specify"
            rows: "must_specify"
            cols: "must_specify"
            cols_active_at_once: "must_specify"
            cell_config: "must_specify"
            average_input_value: "must_specify"
            average_cell_value: "must_specify"
            latency: "must_specify"
            voltage_dac_bits: null
            temporal_dac_bits: null
            temporal_spiking: null
            adc_action_share: 1
            adc_area_share: 1
            read_pulse_width: 1e-9
        subcomponents:
          - name: array_col_drivers
            class: array_col_drivers
            area_share: include_column_drivers
            attributes:
                technology: technology
                rows: rows
                cols: cols
                cols_active_at_once: cols_active_at_once
                cell_config: cell_config
                average_input_value: average_input_value
                average_cell_value: average_cell_value
                latency: latency
                voltage_dac_bits: voltage_dac_bits
                temporal_dac_bits: temporal_dac_bits
                temporal_spiking: temporal_spiking
                read_pulse_width: read_pulse_width
          - name: output_adc
            class: isaac_adc
            attributes:
                n_adcs: n_adcs
                adc_resolution: resolution
                resolution: resolution
                throughput: 1 / latency * cols_active_at_once
                n_components: n_adcs
                technology: technology
                rows: rows
                cols: cols
                cols_active_at_once: cols_active_at_once
                cell_config: cell_config
                average_input_value: average_input_value
                average_cell_value: average_cell_value
                latency: latency
                voltage_dac_bits: voltage_dac_bits
                temporal_dac_bits: temporal_dac_bits
                temporal_spiking: temporal_spiking
                read_pulse_width: read_pulse_width
            area_share: adc_area_share
        actions:
          - name: read
            subcomponents:
              - name: array_col_drivers
                actions:
                  - name: drive
                    action_share: adc_action_share * include_column_drivers
              - name: output_adc
                actions:
                  - name: read
                    action_share: adc_action_share
          - name: write
            subcomponents: []
          - name: idle
            subcomponents:
              - name: array_col_drivers
                actions:
                  - name: idle
              - name: output_adc
                actions:
                  - name: idle
          - name: update
            subcomponents: []
      - name: shift_add_with_adc_action_share
        attributes:
            resolution: "must_specify"
            n_adcs: "must_specify"
            technology: "must_specify"
            rows: "must_specify"
            cols: "must_specify"
            cols_active_at_once: "must_specify"
            cell_config: "must_specify"
            average_input_value: "must_specify"
            average_cell_value: "must_specify"
            latency: "must_specify"
            voltage_dac_bits: null
            temporal_dac_bits: null
            temporal_spiking: null
            adc_action_share: 1
            adc_area_share: 1
            read_pulse_width: 1e-9
        subcomponents:
          - name: shift_add_unit
            class: shift_add_unit
            attributes:
                n_bits: resolution
                shift_register_n_bits: resolution * 2
                n_components: n_adcs
                technology: technology
                rows: rows
                cols: cols
                cols_active_at_once: cols_active_at_once
                cell_config: cell_config
                average_input_value: average_input_value
                average_cell_value: average_cell_value
                latency: latency
                voltage_dac_bits: voltage_dac_bits
                temporal_dac_bits: temporal_dac_bits
                temporal_spiking: temporal_spiking
                read_pulse_width: read_pulse_width
        actions:
          - name: update
            subcomponents:
              - name: shift_add_unit
                actions:
                  - name: shift_add
                    action_share: adc_action_share
          - name: write
            subcomponents: []
          - name: idle
            subcomponents:
              - name: shift_add_unit
                actions:
                  - name: idle
          - name: read
            subcomponents: []
      - name: free_mac
        subcomponents: []
        attributes: {}
        actions:
          - name: compute
            subcomponents: []
      - name: dummy_storage
        subcomponents: []
        attributes: {}
        actions:
          - name: read
            subcomponents: []
          - name: write
            subcomponents: []
          - name: idle
            subcomponents: []
          - name: update
            subcomponents: []
      - name: raella_output_register
        attributes:
            width: "must_specify"
            depth: "must_specify"
            speculation_adc_scale: "must_specify"
            technology: "must_specify"
            entry_bits: "must_specify"
            speculation_enabled: speculation_adc_scale != 1
            n_flags: width * depth // entry_bits
            flag_width: 64
            flag_reads_per_read: (width // entry_bits) / flag_width
            flag_action_share: speculation_enabled * flag_reads_per_read
        subcomponents:
          - name: buf
            class: smartbuffer_sram
            attributes:
                technology: technology
                width: width
                depth: depth
          - name: flags
            class: smartbuffer_sram
            attributes:
                technology: technology
                width: 64
                depth: n_flags // width
        actions:
          - name: read
            subcomponents:
              - name: buf
                actions:
                  - name: read
                    action_share: speculation_adc_scale
              - name: flags
                actions:
                  - name: read
                    action_share: flag_action_share
          - name: update
            subcomponents:
              - name: buf
                actions:
                  - name: write
                    action_share: speculation_adc_scale
              - name: flags
                actions:
                  - name: write
                    action_share: flag_action_share
          - name: idle
            subcomponents:
              - name: buf
                actions:
                  - name: idle
              - name: flags
                actions:
                  - name: idle
          - name: write
            subcomponents:
              - name: buf
                actions:
                  - name: write
                    action_share: speculation_adc_scale
              - name: flags
                actions:
                  - name: write
                    action_share: flag_action_share
      - name: raella_input_buffer
        attributes:
            width: "must_specify"
            depth: "must_specify"
            technology: "must_specify"
            adc_action_share: "must_specify"
            input_bits: "must_specify"
        subcomponents:
          - name: buf
            class: smartbuffer_sram
            attributes:
                width: width
                technology: technology
                read_action_share: 1 if adc_action_share == 1 else 2
                depth: depth
          - name: input_summer
            class: aladdin_adder
            attributes:
                technology: technology
                datawidth: input_bits * 2
                width: input_bits * 2
        actions:
          - name: idle
            subcomponents:
              - name: buf
                actions:
                  - name: idle
          - name: read
            subcomponents:
              - name: buf
                actions:
                  - name: read
                    action_share: 1 if ADC_ACTION_SHARE == 1 else 2
          - name: update
            subcomponents:
              - name: buf
                actions:
                  - name: read
              - name: buf
                actions:
                  - name: write
              - name: input_summer
                actions:
                  - name: add
                    action_share: 2
          - name: write
            subcomponents:
              - name: buf
                actions:
                  - name: read
              - name: buf
                actions:
                  - name: write
              - name: input_summer
                actions:
                  - name: add
                    action_share: 2
      - name: raella_output_center_offset_correct
        attributes:
            width: "must_specify"
            depth: "must_specify"
            technology: "must_specify"
            center_entries: "must_specify"
            buf_width: 64
            read_share: width / buf_width
        subcomponents:
          - name: offsets_buf
            class: smartbuffer_sram
            attributes:
                technology: technology
                width: 64
                depth: center_entries // width * 4
          - name: multiplier
            class: aladdin_multiplier
            attributes:
                technology: technology
                width_a: 4
                width_b: 12
        actions:
          - name: read
            subcomponents:
              - name: offsets_buf
                actions:
                  - name: read
                    action_share: read_share
              - name: multiplier
                actions:
                  - name: multiply
          - name: write
            subcomponents: []
          - name: idle
            subcomponents: []
          - name: update
            subcomponents: []
      - name: raella_dac
        attributes:
            technology: "must_specify"
            rows: "must_specify"
            cols: "must_specify"
            cols_active_at_once: "must_specify"
            cell_config: "must_specify"
            average_input_value: "must_specify"
            average_cell_value: "must_specify"
            latency: "must_specify"
        subcomponents:
          - name: dac_and_gate
            class: nand_gate
            attributes:
                technology: technology
                n_components: n_components
                area_share: n_components
          - name: row_dac
            class: input_row_drivers
            attributes:
                technology: technology
                rows: rows
                cols: cols
                cols_active_at_once: cols_active_at_once
                cell_config: cell_config
                average_input_value: average_input_value
                average_cell_value: average_cell_value
                latency: latency
        actions:
          - name: write
            subcomponents: {}
          - name: idle
            subcomponents:
              - name: row_dac
                actions:
                  - name: idle
          - name: update
            subcomponents: []
          - name: read
            subcomponents:
              - name: row_dac
                actions:
                  - name: read
      - name: shift_add_unit
        attributes:
            technology: "must_specify"
            n_bits: "must_specify"
            shift_register_n_bits: "must_specify"
            n_components: "must_specify"
        subcomponents:
          - name: shift_add[1..n_components]
            class: shift_add
            attributes:
                technology: technology
                n_bits: n_bits
                shift_register_n_bits: shift_register_n_bits
                width: shift_register_n_bits
        actions:
          - name: read
            subcomponents:
              - name: shift_add
                actions:
                  - name: shift_add
          - name: shift_add
            subcomponents:
              - name: shift_add
                actions:
                  - name: shift_add
          - name: write
            subcomponents: {}
          - name: idle
            subcomponents:
              - name: shift_add[1..n_components]
                actions:
                  - name: idle
          - name: update
            subcomponents: []
      - name: smartbuffer_sram
        attributes:
            technology: "must_specify"
            width: "must_specify"
            depth: "must_specify"
            memory_width: max(32, width)
            memory_depth: max(64, depth)
            widthscale: width / memory_width
            depthscale: depth / memory_depth
            real_depth: depth
            area_scale: widthscale * depthscale
            dynamic_energy_scale: widthscale * (depthscale ** (1.56 / 2))
            static_energy_scale: area_scale
            n_rdwr_ports: 1
        subcomponents:
          - name: storage
            class: SRAM
            area_share: area_scale
            attributes:
                technology: technology
                width: memory_width
                depth: memory_depth
                n_rdwr_ports: n_rdwr_ports
          - name: address_generators[0..1]
            class: intadder
            attributes:
                technology: technology
                n_bits: max(1, ceil(log2(real_depth)))
                precision: max(1, ceil(log2(real_depth)))
        actions:
          - name: write
            subcomponents:
              - name: storage
                actions:
                  - name: write
                    action_share: dynamic_energy_scale
              - name: address_generators[0]
                actions:
                  - name: add
          - name: read
            subcomponents:
              - name: storage
                actions:
                  - name: read
                    action_share: dynamic_energy_scale
              - name: address_generators[1]
                actions:
                  - name: add
          - name: idle
            subcomponents:
              - name: storage
                actions:
                  - name: idle
                    action_share: static_energy_scale
              - name: address_generators[0..1]
                actions:
                  - name: idle
          - name: update
            subcomponents:
              - name: storage
                actions:
                  - name: write
                    action_share: dynamic_energy_scale
              - name: address_generators[0]
                actions:
                  - name: add
    check_ignore_macros:
      - technology: "must_specify"
        rows: "must_specify"
        cols: "must_specify"
        cols_active_at_once: "must_specify"
        cell_config: "must_specify"
        average_input_value: "must_specify"
        average_cell_value: "must_specify"
        latency: "must_specify"
        voltage_dac_bits: null
        temporal_dac_bits: null
        temporal_spiking: null
        adc_action_share: 1
        adc_area_share: 1
        read_pulse_width: 1e-9
      - technology: technology
        rows: rows
        cols: cols
        cols_active_at_once: cols_active_at_once
        cell_config: cell_config
        average_input_value: average_input_value
        average_cell_value: average_cell_value
        latency: latency
        voltage_dac_bits: voltage_dac_bits
        temporal_dac_bits: temporal_dac_bits
        temporal_spiking: temporal_spiking
        read_pulse_width: read_pulse_width
mapping: []
mapper:
    optimization_metrics:
      - edp
    live_status: false
    num_threads: 16
    search_size: 500
    victory_condition: 16
    timeout: 500
    max_permutations_per_if_visit: 1
    algorithm: random_pruned
    diagnostics: false
    penalize_consecutive_bypass_fails: true
    out_prefix: timeloop_mapper
    optimization_metric: []
    sync_interval: null
    log_interval: 1
    log_oaves: false
    log_oaves_mappings: false
    log_stats: false
    log_suboptimal: false
    emit_whoop_nest: false
    filter_revisits: false
